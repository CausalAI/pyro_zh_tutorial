{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "**知识点:** 为了从数据中学习模型并对其进行推理，我们需要 be able to do inference. Pyro 包含 `pyro.do`，这是 Pearl 的 `do`-operator 的实现，用于因果推断。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "# Pyro 推断简介\n",
    "\n",
    "现代机器学习的许多内容可以理解成近似推断并且使用 Pyro 这样的语言表达出来. To motivate the rest of this tutorial, 让我们为一个简单的物理问题建立一个生成模型，以便我们可以使用 Pyro 的推理机制来解决它。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import torch\n",
    "\n",
    "import pyro\n",
    "import pyro.infer\n",
    "import pyro.optim\n",
    "import pyro.distributions as dist\n",
    "\n",
    "pyro.set_rng_seed(101)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "假设我们试图得到某物的重量，但是我们使用的秤是不可靠的，并且每当我们称量同一物体时会给出稍微变动的读数。我们可以尝试 compensate for this variability by integrating the noisy measurement information with **a guess based on some prior knowledge about the object**, like its density or material properties. 我们用以下概率模型来模拟：\n",
    "\n",
    "$${\\sf weight} \\,  \\sim \\cal {\\sf Normal}({\\mu}, 1) $$\n",
    "$${\\sf measurement} \\, |  {\\sf weight} \\sim {\\sf Normal}({\\sf weight}, 0.75)$$\n",
    "\n",
    "其中，第一个式子表示该物体重量的先验分布，第二个式子表示对其进行测量的结果。该模型对应于以下随机函数："
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def scale(mu):\n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.0))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "# Hint for the next section\n",
    "def scale_obs(mu): \n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75), obs=9.5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 随机函数的条件化\n",
    "\n",
    "概率编程的真正威力是把生成模型对观测数据条件化并且推断产生观测数据的隐变量的能力。在 Pyro 中，we separate the expression of conditioning from its evaluation via inference, 使得我们能够只写一个随机函数 `model` 而对许多不同的样本进行条件化. Pyro suppors constraining a model's internal `sample` statements to be equal to a given set of observations."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "再次考虑称重的例子，也就是 `scale`. 假设 `weight` 的分布参数 `mu = 8.5`, 然后我们得到该物理的一个测量 `measurement = 9.5`. 那么，需要推断的是 `weight` 的后验分布:\n",
    "\n",
    "$$p({\\sf weight} \\, |{\\sf measurement}=9.5 \\,; \\, \\mu=8.5) = \\, ? $$\n",
    "\n",
    "Pyro provides the function `pyro.condition` to allow us to constrain the values of sample statements.  `pyro.condition` 是一个输入是 a model and a dictionary of observations 的高阶函数， 它的输出是 a new model that has the same input and output signatures but always uses the given values at observed `sample` statements:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9.5"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mu = 8.5\n",
    "conditioned_scale = pyro.condition(scale, data={\"measurement\": 9.5})\n",
    "# Input of `pyro.condition`: a model and a dictionary of observations\n",
    "conditioned_scale(mu)\n",
    "# Always uses the given values at observed sample statements!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "因果它就像常规 Python 函数, conditioning can be deferred or parametrized with Python's `lambda` or `def`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def deferred_conditioned_scale(measurement, mu):\n",
    "    return pyro.condition(scale, data={\"measurement\": measurement})(mu)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "在某些情况下，直接在 `pyro.sample` 语句中而不是使用 `pyro.condition` 定义条件化可能更方便. `pyro.sample` 的可选参数 `obs` 就是用于定义条件化:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def scale_obs(mu):  # equivalent to conditioned_scale above\n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.))\n",
    "     # here we condition on measurement == 9.5\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75), obs=9.5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "最后，除了用于合并观察数据的 `pyro.condition` 之外，Pyro还包含 `pyro.do`，这是 Pearl 的 `do`-operator 的实现，用于因果推断，其接口与 `pyro.condition` 相同。`condition` and `do` 可以自由混合和组合，使Pyro成为基于模型的因果推断的强大工具。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 用指导分布近似后验\n",
    "\n",
    "我们可以使用指导函数(guide function)进行灵活的近似推断。\n",
    "\n",
    "让我们回到 `conditioned_scale`。现在我们有一个对 `measurement` 条件化的模型(model)，于是我们可以使用 Pyro 的近似推理算法来估计 `weight` 已知参数 `mu` 和给定观测数据 `measurement = data` 的后验分布. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def scale_obs(mu): \n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75), obs=9.5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "Pyro中的推理算法，例如 `pyro.infer.SVI`，允许我们使用任意随机函数，我们将其称为指导函数(*guide functions* or *guides*)，作为近似后验分布， 指导函数必须满足以下两个条件才能成为特定模型的有效近似后验分布： \n",
    "\n",
    "1. 所有的非观测变量抽样语句需要在 model 和 guide 中同时出现。\n",
    "2. 模型分布和指导分布具有相同的输入参数 (input signature).\n",
    "\n",
    "指导函数的作用(或者角色)是：\n",
    "\n",
    "- 作为一个可编程和数据依赖的建议分布(proposal distribution) 用于重要采样, 拒绝采样, 序列蒙特卡罗采样, MCMC, and independent Metropolis-Hastings, and \n",
    "- 作为一个变分分布(variational distributions or inference networks) 用于随机变分推理。 \n",
    "\n",
    "目前，重要性抽样，MCMC和随机变分推断已在 Pyro 中实现，我们计划在将来添加其他算法。\n",
    "\n",
    "\n",
    "尽管指导函数的定义在不同的推断算法中有所不同，但通常应选择 guide function，使其原则上具有足够的灵活性 to closely approximate the distribution over all unobserved `sample`(也就是非条件化的变量) statements in the model. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "在我们的例子 `scale` 中, `weight` 给定参数 `mu` 和观测 `measurement` 的真实后验分布是 $N(9.14, 0.6)$。 (模型非常简单，因此我们可以解析的得到后验分布, for derivation, see for example [Section 3.4 of this book](http://www.stat.cmu.edu/~brian/463-663/week09/Chapter%2003.pdf).)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def perfect_guide(mu):\n",
    "    loc =(0.75**2 * mu + 9.5) / (1 + 0.75**2) # 9.14\n",
    "    scale = np.sqrt(0.75**2/(1 + 0.75**2)) # 0.6\n",
    "    return pyro.sample(\"weight\", dist.Normal(loc, scale))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "# Hint for the next section\n",
    "from torch.distributions import constraints\n",
    "def scale_parametrized_guide_constrained(mu):\n",
    "    a = pyro.param(\"a\", torch.tensor(mu))\n",
    "    b = pyro.param(\"b\", torch.tensor(1.), constraint=constraints.positive)\n",
    "    return pyro.sample(\"weight\", dist.Normal(a, b)) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 参数化模型和变分推断\n",
    "\n",
    "Parametrized Stochastic Functions and Variational Inference\n",
    "\n",
    "尽管我们可以写出 `scale` 的精确后验分布，但是总的来说，指定一个近似于任意条件随机函数的后验分布的指导分布是很困难的。实际上，可以计算精确后验的随机函数是很少见的。例如，即使在我们的例子 `scale` 中，如果随机函数的中间过程存在某种非线性，那么可能就是无法计算其精确后验分布:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "# 随机函数无法计算精确后验分布\n",
    "def intractable_scale(guess):\n",
    "    weight = pyro.sample(\"weight\", dist.Normal(guess, 1.0))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(some_nonlinear_function(weight), 0.75))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "因此我们的做法是使用 top-level function `pyro.param` 来定义一族指导分布 indexed by named parameters, 然后在这族分布中搜索在某种损失意义下最接近真实后验分布的指导分布。这种近似后验推断的方法称为“变分推断”。\n",
    "\n",
    "\n",
    "`pyro.param` 是一个 Pyro's 键值参数存储区(key-value parameter store) 的前端，which is described in more detail in the documentation. 像 `pyro.sample` 一样，`pyro.param` 总是以 name 作为第一个参数来调用。 `pyro.param` 第一次带特定 name 的调用之后, 它把它的参数存储在 parameter store 中, 然后返回该值。之后，当使用该名称进行调用时，它从参数存储区返回值 regardless of any other arguments。这里类似于此处的 `simple_param_store.setdefault` , 但具有一些附加的跟踪和管理功能。\n",
    "\n",
    "\n",
    "\n",
    "```python\n",
    "simple_param_store = {}\n",
    "a = simple_param_store.setdefault(\"a\", torch.randn(1))\n",
    "```\n",
    "\n",
    "For example, we can parametrize `a` and `b` in `scale_posterior_guide` instead of specifying them by hand:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "def scale_parametrized_guide(mu):\n",
    "    a = pyro.param(\"a\", torch.tensor(mu))\n",
    "    b = pyro.param(\"b\", torch.tensor(1.))\n",
    "    return pyro.sample(\"weight\", dist.Normal(a, torch.abs(b)))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "As an aside, note that in `scale_parametrized_guide`, we had to apply `torch.abs` to parameter `b` 是因为正态分布的标准差必须为正; 类似的约束同样适用于其他许多分布的参数. PyTorch 分布库提供了 [约束模块(constraints module)](https://pytorch.org/docs/master/distributions.html#module-torch.distributions.constraints) 用于实现此类约束, and applying constraints to Pyro parameters is as easy as passing the relevant `constraint` object to `pyro.param`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "from torch.distributions import constraints\n",
    "\n",
    "def scale_parametrized_guide_constrained(mu):\n",
    "    a = pyro.param(\"a\", torch.tensor(mu))\n",
    "    b = pyro.param(\"b\", torch.tensor(1.), constraint=constraints.positive)\n",
    "    return pyro.sample(\"weight\", dist.Normal(a, b))  # no more torch.abs"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "Pyro is built to enable *stochastic variational inference*, a powerful and widely applicable class of variational inference algorithms with 三个关键特征: \n",
    "\n",
    "1. 参数都是实数值张量\n",
    "2. 我们使用模型分布和指导分布的 samples of execution histories 来计算损失函数的蒙特卡罗估计\n",
    "3. 我们使用随机梯度下降法搜索最佳参数。 \n",
    "\n",
    "将随机梯度下降与 PyTorch 的 GPU 加速张量数学和自动微分相结合，使我们能够在高维参数空间和大规模数据下进行变分推断。\n",
    "\n",
    "\n",
    "有关 Pyro 的 SVI 功能详细描述参见 [SVI tutorial](svi_part_i.ipynb). "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 例子完整代码\n",
    "\n",
    "我们使用变分推断估计 `scale` 在已知参数 $\\mu=8.5$，给定观测 `measurement=9.5` 之后的后验分布:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "a =  9.107474327087402\n",
      "b =  0.6285384893417358\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import torch\n",
    "\n",
    "import pyro\n",
    "import pyro.infer\n",
    "import pyro.optim\n",
    "import pyro.distributions as dist\n",
    "pyro.set_rng_seed(101)\n",
    "mu = 8.5\n",
    "\n",
    "def scale(mu):\n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.0))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75))\n",
    "conditioned_scale = pyro.condition(scale, data={\"measurement\": 9.5})\n",
    "\n",
    "def scale_parametrized_guide(mu):\n",
    "    a = pyro.param(\"a\", torch.tensor(mu))\n",
    "    b = pyro.param(\"b\", torch.tensor(1.))\n",
    "    return pyro.sample(\"weight\", dist.Normal(a, torch.abs(b)))\n",
    "\n",
    "pyro.clear_param_store()\n",
    "svi = pyro.infer.SVI(model=conditioned_scale, \n",
    "                     guide=scale_parametrized_guide,\n",
    "                     optim=pyro.optim.SGD({\"lr\": 0.001, \"momentum\":0.1}),\n",
    "                     loss=pyro.infer.Trace_ELBO())\n",
    "\n",
    "losses, a,b  = [], [], []\n",
    "num_steps = 2500\n",
    "for t in range(num_steps):\n",
    "    losses.append(svi.step(mu))\n",
    "    a.append(pyro.param(\"a\").item())\n",
    "    b.append(pyro.param(\"b\").item())\n",
    "    \n",
    "plt.plot(losses)\n",
    "plt.title(\"ELBO\")\n",
    "plt.xlabel(\"step\")\n",
    "plt.ylabel(\"loss\");\n",
    "print('a = ',pyro.param(\"a\").item())\n",
    "print('b = ', pyro.param(\"b\").item())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.subplot(1,2,1)\n",
    "plt.plot([0,num_steps],[9.14,9.14], 'k:')\n",
    "plt.plot(a)\n",
    "plt.ylabel('a')\n",
    "\n",
    "plt.subplot(1,2,2)\n",
    "plt.ylabel('b')\n",
    "plt.plot([0,num_steps],[0.6,0.6], 'k:')\n",
    "plt.plot(b)\n",
    "plt.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "**注意，因为我们定义的指导分布和真实后验分布是同一族分布，所以SVI获得的参数非常接近真实参数。**\n",
    "\n",
    "\n",
    "由于优化过程会更新参数存储区中指导分布的参数, 所以一旦我们找到了好的参数, 我们可以将指导分布的样本作为后验样本用于后续任务.\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 拆解成梯度下降法\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Before updated: tensor(8.5000, requires_grad=True) tensor(1., requires_grad=True)\n",
      "After updated: tensor(9.0979, requires_grad=True) tensor(0.6203, requires_grad=True)\n",
      "a =  9.097911834716797\n",
      "b =  0.6202840209007263\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import torch\n",
    "\n",
    "import pyro\n",
    "import pyro.infer\n",
    "import pyro.optim\n",
    "import pyro.distributions as dist\n",
    "pyro.set_rng_seed(101)\n",
    "mu = 8.5\n",
    "\n",
    "def scale(mu):\n",
    "    weight = pyro.sample(\"weight\", dist.Normal(mu, 1.0))\n",
    "    return pyro.sample(\"measurement\", dist.Normal(weight, 0.75))\n",
    "conditioned_scale = pyro.condition(scale, data={\"measurement\": torch.tensor(9.5)})\n",
    "\n",
    "def scale_parametrized_guide(mu):\n",
    "    a = pyro.param(\"a\", torch.tensor(mu))\n",
    "    b = pyro.param(\"b\", torch.tensor(1.))\n",
    "    return pyro.sample(\"weight\", dist.Normal(a, torch.abs(b)))\n",
    "\n",
    "loss_fn = pyro.infer.Trace_ELBO().differentiable_loss\n",
    "\n",
    "pyro.clear_param_store()\n",
    "\n",
    "with pyro.poutine.trace(param_only=True) as param_capture:\n",
    "    loss = loss_fn(conditioned_scale, scale_parametrized_guide, mu)\n",
    "    loss.backward()\n",
    "params = [site[\"value\"].unconstrained() for site in param_capture.trace.nodes.values()]\n",
    "\n",
    "def step(params):\n",
    "    for x in params:\n",
    "        x.data = x.data - lr * x.grad\n",
    "        x.grad.zero_()\n",
    "\n",
    "print(\"Before updated:\", pyro.param('a'), pyro.param('b'))\n",
    "losses, a,b  = [], [], []\n",
    "lr = 0.001\n",
    "num_steps = 1000\n",
    "for t in range(num_steps):\n",
    "    with pyro.poutine.trace(param_only=True) as param_capture:\n",
    "        loss = loss_fn(conditioned_scale, scale_parametrized_guide, mu)\n",
    "        loss.backward()\n",
    "        losses.append(loss.data)\n",
    "    params = [site[\"value\"].unconstrained() for site in param_capture.trace.nodes.values()]\n",
    "\n",
    "    a.append(pyro.param(\"a\").item())\n",
    "    b.append(pyro.param(\"b\").item())\n",
    "    step(params)\n",
    "print(\"After updated:\", pyro.param('a'), pyro.param('b'))\n",
    "\n",
    "\n",
    "plt.plot(losses)\n",
    "plt.title(\"ELBO\")\n",
    "plt.xlabel(\"step\")\n",
    "plt.ylabel(\"loss\");\n",
    "print('a = ',pyro.param(\"a\").item())\n",
    "print('b = ', pyro.param(\"b\").item())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.subplot(1,2,1)\n",
    "plt.plot([0,num_steps],[9.14,9.14], 'k:')\n",
    "plt.plot(a)\n",
    "plt.ylabel('a')\n",
    "\n",
    "plt.subplot(1,2,2)\n",
    "plt.ylabel('b')\n",
    "plt.plot([0,num_steps],[0.6,0.6], 'k:')\n",
    "plt.plot(b)\n",
    "plt.tight_layout()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## 下一步？\n",
    "\n",
    "在 [Variational Autoencoder tutorial](vae.ipynb) 中，我们将会看到如何使用深度神经网络来增强 `scale` 这样的模型，以及使用随机变分推断来建立图像生成模型."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
